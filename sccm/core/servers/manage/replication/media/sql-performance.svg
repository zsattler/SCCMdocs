<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by Microsoft Visio, SVG Export sql-performance.svg Page-1 -->
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"
		width="7.88889in" height="9.88889in" viewBox="0 0 568 712" xml:space="preserve" color-interpolation-filters="sRGB"
		class="st16">
	<style type="text/css">
	<![CDATA[
		.st1 {fill:#ffffff;stroke:#c3c3c3;stroke-linecap:round;stroke-linejoin:round;stroke-width:1}
		.st2 {fill:#ffc000;stroke:#000000;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5}
		.st3 {fill:#000000;font-family:Segoe UI;font-size:0.666664em;font-weight:bold}
		.st4 {fill:#a3d9f4;stroke:#000000;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5}
		.st5 {font-size:1em}
		.st6 {fill:none;stroke:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.5}
		.st7 {fill:#000000;font-family:Segoe UI;font-size:0.666664em}
		.st8 {marker-end:url(#mrkr4-23);stroke:#000000;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5}
		.st9 {fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;stroke-width:0.37313432835821}
		.st10 {fill:#000000;font-family:Segoe UI;font-size:1.16666em}
		.st11 {fill:#00aba9;stroke:#000000;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5}
		.st12 {fill:#ffffff;stroke:none;stroke-linecap:butt;stroke-width:7.2}
		.st13 {fill:#ffffff;stroke:none;stroke-linecap:butt}
		.st14 {stroke:#7f7f7f;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5}
		.st15 {fill:#000000;font-family:Segoe UI;font-size:0.499992em}
		.st16 {fill:none;fill-rule:evenodd;font-size:12px;overflow:visible;stroke-linecap:square;stroke-miterlimit:3}
	]]>
	</style>

	<defs id="Markers">
		<g id="lend4">
			<path d="M 2 1 L 0 0 L 2 -1 L 2 1 " style="stroke:none"/>
		</g>
		<marker id="mrkr4-23" class="st9" refX="-5.36" orient="auto" markerUnits="strokeWidth" overflow="visible">
			<use xlink:href="#lend4" transform="scale(-2.68,-2.68) "/>
		</marker>
	</defs>
	<g>
		<title>Page-1</title>
		<g id="shape93-1" transform="translate(0.5,-0.5)">
			<title>Sheet.93</title>
			<rect x="0" y="0.999995" width="567" height="711" class="st1"/>
		</g>
		<g id="shape20-3" transform="translate(252.412,-652.916)">
			<title>Start/End.10</title>
			<desc>Start</desc>
			<path d="M10.35 712 L31.05 712 A10.35 11.025 -180 0 0 31.05 689.95 L10.35 689.95 A10.35 11.025 -180 1 0 10.35 712 Z"
					class="st2"/>
			<text x="11.6" y="703.38" class="st3">Start</text>		</g>
		<g id="shape21-6" transform="translate(252.5,-565.918)">
			<title>Process.13</title>
			<desc>CAS /Primary</desc>
			<rect x="0" y="673.904" width="41.4" height="38.0962" class="st4"/>
			<text x="10.27" y="690.55" class="st3">CAS /<tspan x="5.95" dy="1.2em" class="st5">Primary</tspan></text>		</g>
		<g id="shape22-10" transform="translate(304.2,-616.466)">
			<title>Sheet.22</title>
			<desc>Troubleshoot SQL performance that can impact replication status</desc>
			<rect x="0" y="653.5" width="130.5" height="58.5" class="st6"/>
			<text x="2" y="662.7" class="st7">Troubleshoot SQL performance <tspan x="2" dy="1.2em" class="st5">that can impact replication status </tspan></text>		</g>
		<g id="shape23-14" transform="translate(303.036,-566.966)">
			<title>Sheet.23</title>
			<desc>Check if site is in maintenance mode</desc>
			<rect x="0" y="674.952" width="113.664" height="37.0481" class="st6"/>
			<text x="2" y="691.08" class="st3">Check if site is in <tspan x="2" dy="1.2em" class="st5">maintenance mode</tspan></text>		</g>
		<g id="shape24-18" transform="translate(264.156,-652.916)">
			<title>Dynamic connector.1114</title>
			<path d="M8.96 712 L9.03 752.86" class="st8"/>
		</g>
		<g id="shape26-24" transform="translate(0.5,-682.466)">
			<title>Sheet.26</title>
			<desc>Troubleshoot SQL performance</desc>
			<rect x="0" y="683.5" width="567" height="28.5" class="st6"/>
			<text x="186.85" y="701.95" class="st10">Troubleshoot SQL performance</text>		</g>
		<g id="shape65-27" transform="translate(261.5,-504.5)">
			<title>Process.1109</title>
			<rect x="0" y="694.45" width="23.4" height="17.55" class="st4"/>
		</g>
		<g id="shape66-29" transform="translate(300.631,-491)">
			<title>Sheet.66</title>
			<desc>Make sure SQL change tracking table is cleaned up</desc>
			<rect x="0" y="680.5" width="113.869" height="31.5" class="st6"/>
			<text x="2" y="689.7" class="st3">Make sure SQL change <tspan x="2" dy="1.2em" class="st5">tracking table is cleaned up</tspan></text>		</g>
		<g id="shape68-33" transform="translate(285.6,-565.918)">
			<title>Dynamic connector.68</title>
			<path d="M-5.6 712 L-12.4 712 L-12.4 747.83" class="st8"/>
		</g>
		<g id="shape69-38" transform="translate(261,-405.725)">
			<title>Decision.1066</title>
			<path d="M0 703.22 L11.7 694.45 L23.4 703.22 L11.7 712 L0 703.22 Z" class="st2"/>
		</g>
		<g id="shape70-40" transform="translate(281.95,-504.5)">
			<title>Dynamic connector.70</title>
			<path d="M-8.75 712 L-9.2 785.19" class="st8"/>
		</g>
		<g id="shape71-45" transform="translate(447.566,-385.25)">
			<title>Start/End.1184</title>
			<desc>Contact Microsoft Support to clean up SQL server change track...</desc>
			<path d="M28.47 712 L85.4 712 A28.4672 29.25 -180 0 0 85.4 653.5 L28.47 653.5 A28.4672 29.25 -180 1 0 28.47 712 Z"
					class="st11"/>
			<text x="6.75" y="675.55" class="st3">Contact Microsoft Support <tspan x="15.07" dy="1.2em" class="st5">to clean up SQL server </tspan><tspan
						x="26.8" dy="1.2em" class="st5">change tracking</tspan></text>		</g>
		<g id="shape72-50" transform="translate(284.4,-423.5)">
			<title>Dynamic connector.1094</title>
			<desc>Reported SQL server issue</desc>
			<path d="M0 721 L155.13 721" class="st8"/>
			<rect x="32.7822" y="716.2" width="97.6012" height="9.59985" class="st12"/>
			<text x="32.78" y="723.4" class="st3">Reported SQL server issue</text>		</g>
		<g id="shape73-57" transform="translate(263.7,-405.725)">
			<title>Dynamic connector.73</title>
			<desc>No issue detected related to change tracking cleanup</desc>
			<path d="M9 712 L9 785.18" class="st8"/>
			<rect x="-43.9821" y="729.625" width="105.964" height="19.1997" class="st12"/>
			<text x="-43.98" y="736.83" class="st3">No issue detected related to  <tspan x="-36.93" dy="1.2em" class="st5">change tracking cleanup</tspan></text>		</g>
		<g id="shape76-65" transform="translate(261.5,-306.95)">
			<title>Process.72</title>
			<rect x="0" y="694.45" width="23.4" height="17.55" class="st4"/>
		</g>
		<g id="shape78-67" transform="translate(297.627,-299.75)">
			<title>Sheet.78</title>
			<desc>Change current sessions that handle SQL service broker messag...</desc>
			<rect x="0" y="680.5" width="113.869" height="31.5" class="st6"/>
			<text x="2" y="689.7" class="st3">Change current sessions that <tspan x="2" dy="1.2em" class="st5">handle SQL service broker </tspan><tspan
						x="2" dy="1.2em" class="st5">messages are blocked</tspan></text>		</g>
		<g id="shape79-72" transform="translate(261.5,-216.95)">
			<title>Decision.79</title>
			<path d="M0 703.22 L11.7 694.45 L23.4 703.22 L11.7 712 L0 703.22 Z" class="st2"/>
		</g>
		<g id="shape80-74" transform="translate(264.2,-306.95)">
			<title>Dynamic connector.80</title>
			<path d="M9 712 L9 776.41" class="st8"/>
		</g>
		<g id="shape81-79" transform="translate(284.9,-225.725)">
			<title>Dynamic connector.81</title>
			<desc>If wait_type is COMMIT_TABLE</desc>
			<path d="M0 712 L219.6 712 L219.6 560.51" class="st8"/>
			<rect x="132.154" y="707.2" width="114.816" height="9.59985" class="st13"/>
			<text x="132.15" y="714.4" class="st3">If wait_type is COMMIT_TABLE</text>		</g>
		<g id="shape82-86" transform="translate(444.631,-126.5)">
			<title>Start/End.82</title>
			<desc>Review the blocking session</desc>
			<path d="M28.47 712 L85.4 712 A28.4672 29.25 -180 0 0 85.4 653.5 L28.47 653.5 A28.4672 29.25 -180 1 0 28.47 712 Z"
					class="st11"/>
			<text x="4.36" y="685.15" class="st3">Review the blocking session</text>		</g>
		<g id="shape83-89" transform="translate(273.2,-216.95)">
			<title>Dynamic connector.83</title>
			<desc>If blocking_session_id is not 0</desc>
			<path d="M0 712 L0 773.2 L163.39 773.2" class="st8"/>
			<rect x="14.581" y="763.6" width="81.0692" height="19.1997" class="st12"/>
			<text x="14.58" y="770.8" class="st3">If blocking_session_id  <tspan x="41.29" dy="1.2em" class="st5">is not 0</tspan></text>		</g>
		<g id="shape84-97" transform="translate(261,-81.5)">
			<title>Process.84</title>
			<rect x="0" y="694.45" width="23.4" height="17.55" class="st4"/>
		</g>
		<g id="shape86-99" transform="translate(281.95,-216.95)">
			<title>Dynamic connector.86</title>
			<path d="M-8.75 712 L-9.22 821.86" class="st8"/>
		</g>
		<g id="shape87-104" transform="translate(297.627,-68)">
			<title>Sheet.87</title>
			<desc>Check sessions asking too much memory</desc>
			<rect x="0" y="680.5" width="113.869" height="31.5" class="st6"/>
			<text x="2" y="689.7" class="st3">Check sessions asking too <tspan x="2" dy="1.2em" class="st5">much memory</tspan></text>		</g>
		<g id="shape88-108" transform="translate(261.5,-27.5)">
			<title>Process.88</title>
			<rect x="0" y="694.45" width="23.4" height="17.55" class="st4"/>
		</g>
		<g id="shape90-110" transform="translate(263.95,-81.5)">
			<title>Dynamic connector.90</title>
			<path d="M8.75 712 L9.14 740.41" class="st8"/>
		</g>
		<g id="shape91-115" transform="translate(297.627,-18.5)">
			<title>Sheet.91</title>
			<desc>Check sessions taking too many locks</desc>
			<rect x="0" y="680.5" width="113.869" height="31.5" class="st6"/>
			<text x="2" y="689.7" class="st3">Check sessions taking too <tspan x="2" dy="1.2em" class="st5">many locks</tspan></text>		</g>
		<g id="shape67-119" transform="translate(9.5,-421.269)">
			<title>Orthogonal.70</title>
			<desc>DECLARE @RetentionUnit INT = 0; DECLARE @RetentionPeriod INT ...</desc>
			<path d="M235.41 619.95 L252 619.97" class="st14"/>
			<path d="M4.5 527.5 L0 527.5 L0 712 L4.5 712" class="st14"/>
			<path d="M230.91 527.5 L235.41 527.5 L235.41 712 L230.91 712" class="st14"/>
			<text x="4" y="538.75" class="st15">DECLARE @RetentionUnit INT = 0; <tspan x="4" dy="1.2em" class="st5">DECLARE @RetentionPeriod INT = 0; </tspan><tspan
						x="4" dy="1.2em" class="st5">DECLARE @CTCutOffTime DATETIME; </tspan><tspan x="4" dy="1.2em" class="st5">DECLARE @CTMinTime DATETIME;  </tspan><tspan
						x="4" dy="2.4em" class="st5">SELECT @RetentionPeriod=retention_period, </tspan><tspan x="4" dy="1.2em"
						class="st5">    </tspan>@RetentionUnit=retention_period_units   <tspan x="4" dy="1.2em" class="st5">FROM sys.change_tracking_databases   </tspan><tspan
						x="4" dy="1.2em" class="st5">WHERE database_id = DB_ID();   </tspan><tspan x="4" dy="2.4em" class="st5">IF @RetentionUnit = 1 </tspan><tspan
						x="4" dy="1.2em" class="st5">    </tspan>SET @CTCutOffTime = DATEADD(MINUTE,-@RetentionPeriod,GETUTCDATE())  <tspan
						x="4" dy="1.2em" class="st5">ELSE IF @RetentionUnit = 2 </tspan><tspan x="4" dy="1.2em" class="st5">    </tspan>SET @CTCutOffTime = DATEADD(HOUR,-@RetentionPeriod,GETUTCDATE())  <tspan
						x="4" dy="1.2em" class="st5">ELSE IF @RetentionUnit = 3 </tspan><tspan x="4" dy="1.2em" class="st5">    </tspan>SET @CTCutOffTime = DATEADD(DAY,-@RetentionPeriod,GETUTCDATE())   <tspan
						x="4" dy="2.4em" class="st5">--</tspan> give a buffer of two days <tspan x="4" dy="1.2em" class="st5">SET @CTCutOffTime = DATEADD(DAY, </tspan>-2, @CTCutOffTime)  <tspan
						x="4" dy="1.2em" class="st5">select top 1 @CTMinTime=commit_time from sys.dm_tran_commit_table order by </tspan><tspan
						x="4" dy="1.2em" class="st5">commit_ts asc </tspan><tspan x="4" dy="1.2em" class="st5">IF @CTMinTime &#60; @CTCutOffTime </tspan><tspan
						x="4" dy="1.2em" class="st5">    </tspan>PRINT &#39;there is change tracking backlog, please contact Microsoft support&#39;</text>		</g>
		<g id="shape77-144" transform="translate(9.5,-270.5)">
			<title>Orthogonal.1110</title>
			<desc>select req.session_id ,req.blocking_session_id ,req.last_wait...</desc>
			<path d="M235.41 666.82 L252 666.79" class="st14"/>
			<path d="M4.5 622 L0 622 L0 712 L4.5 712" class="st14"/>
			<path d="M230.91 622 L235.41 622 L235.41 712 L230.91 712" class="st14"/>
			<text x="4" y="632.8" class="st15">select <tspan x="4" dy="1.2em" class="st5">       </tspan>req.session_id <tspan
						x="4" dy="1.2em" class="st5">       </tspan>,req.blocking_session_id <tspan x="4" dy="1.2em" class="st5">       </tspan>,req.last_wait_type <tspan
						x="4" dy="1.2em" class="st5">       </tspan>,req.wait_type <tspan x="4" dy="1.2em" class="st5">       </tspan>,req.wait_resource <tspan
						x="4" dy="1.2em" class="st5">       </tspan>,t.text <tspan x="4" dy="1.2em" class="st5">from sys.dm_exec_sessions s </tspan><tspan
						x="4" dy="1.2em" class="st5">inner join sys.dm_exec_requests req on s.Session_id=req.session_id </tspan><tspan
						x="4" dy="1.2em" class="st5">cross apply sys.dm_exec_sql_text(sql_handle) t </tspan><tspan x="4" dy="1.2em"
						class="st5">where program_name=&#39;SMS_data_replication_service&#39;</tspan></text>		</g>
		<g id="shape85-160" transform="translate(2.85774,-79.25)">
			<title>Orthogonal.85</title>
			<desc>SELECT * FROM sys.dm_exec_query_memory_grants ORDER BY reques...</desc>
			<path d="M235.41 700.92 L258.14 700.96" class="st14"/>
			<path d="M4.5 689.5 L0 689.5 L0 712 L4.5 712" class="st14"/>
			<path d="M230.91 689.5 L235.41 689.5 L235.41 712 L230.91 712" class="st14"/>
			<text x="4" y="698.95" class="st15">SELECT * FROM sys.dm_exec_query_memory_grants <tspan x="4" dy="1.2em" class="st5">ORDER BY requested_memory_kb DESC</tspan></text>		</g>
		<g id="shape89-167" transform="translate(3.35775,-8.96564)">
			<title>Orthogonal.89</title>
			<desc>SELECT TOP 10 request_session_id, program_name = (SELECT prog...</desc>
			<path d="M235.41 684.25 L258.14 684.54" class="st14"/>
			<path d="M4.5 653.5 L0 653.5 L0 712 L4.5 712" class="st14"/>
			<path d="M230.91 653.5 L235.41 653.5 L235.41 712 L230.91 712" class="st14"/>
			<text x="4" y="662.95" class="st15">SELECT TOP 10 request_session_id,  <tspan x="4" dy="1.2em" class="st5">program_name = (SELECT program_name FROM sys.dm_exec_sessions WHERE </tspan><tspan
						x="4" dy="1.2em" class="st5">session_id=request_session_id), </tspan><tspan x="4" dy="1.2em" class="st5">COUNT (*) num_locks </tspan><tspan
						x="4" dy="1.2em" class="st5">FROM sys.dm_tran_locks </tspan><tspan x="4" dy="1.2em" class="st5">GROUP BY request_session_id  </tspan><tspan
						x="4" dy="1.2em" class="st5">ORDER BY count (*) DESC</tspan></text>		</g>
	</g>
</svg>
